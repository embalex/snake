(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getObject3DByName",(function(){return S})),n.d(r,"getObject3DPositionByName",(function(){return P})),n.d(r,"setObject3DPositionByName",(function(){return R})),n.d(r,"isSceneReady",(function(){return D}));var o={};n.r(o),n.d(o,"OrbitControls",(function(){return ne.b}));var i,c,a,u=n(7),s=n(1),f=n.n(s),l=n(28),p=n.n(l),j=n(14),d=n(10),b=20,m=1e3,h=40,g={x:10,y:10,angle:180},O=700,v=10,y="ducky",x="apple",w="ambientLight",A=function(e){return"".concat("magmacube").concat(e)},M=n(9),S=function(e,t){var n=e.children.find((function(e){return e.name===t}));if(void 0===n)throw new Error("getObject3DByName. Can't find model with name=".concat(t,", scene=").concat(e));return n},P=function(e,t){var n=S(e,t);return{x:n.position.x,y:n.position.y,angle:n.rotation.z}},R=function(e,t,n,r){var o=S(e,t);o.position.setX(n.x),o.position.setY(n.y),o.position.setZ(r?-100:0),o.rotation.set(0,0,n.angle)},D=function(e){try{return S(e,y),S(e,x),!0}catch(t){return!1}},I=Object(s.forwardRef)((function(e,t){var n=Object(M.h)().scene;return null!==t&&"function"!==typeof t&&(t.current=n),null})),k=r,B=function(e){return e*Math.PI/180},E=10,L=function(e){return"number"===typeof e?e-E:{x:e.x-E,y:e.y-E}},N=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=L({x:n.x,y:n.y}),i=o.x,c=o.y,a=B(n.angle);k.setObject3DPositionByName(e,t,{x:i,y:c,angle:a},r)},C=function(e,t){var n,r=k.getObject3DPositionByName(e,t),o="number"===typeof(n={x:r.x,y:r.y})?n+E:{x:n.x+E,y:n.y+E};return{x:o.x,y:o.y,angle:r.angle/Math.PI*180}},T=function(e,t){var n=e.x,r=e.y;return t.filter((function(e){var t=e.x,o=e.y;return t===n&&o===r})).length>0},U=function(e){for(var t=function(){return[Math.floor(Math.random()*b),Math.floor(Math.random()*b)]},n=t(),r=Object(d.a)(n,2),o=r[0],i=r[1];T({x:o,y:i},e);){var c=t(),a=Object(d.a)(c,2);o=a[0],i=a[1]}return{x:o,y:i,angle:0}},F=function(e){var t=U([g]);return{reset:function(){t=U([g])},step:function(n){var r=e.current;if(!r)return{isSnakeEatApple:!1};var o=function(e,t,n){var r=function(e,t){return function(e,t){var n=e.x,r=e.y,o=t.x,i=t.y;return n===o&&r===i}(e,t[0])}(t,n),o=t;return r&&(o=U(n)),N(e,x,o),{isSnakeEatApple:r,actualApplePosition:o}}(r,t,n),i=o.isSnakeEatApple,c=o.actualApplePosition;return t=c,{isSnakeEatApple:i}}}},K=function(e){k.getObject3DByName(e,w).intensity=0},Z=function(e){var t=function(){var e=[];return new Array(h).fill(0).forEach((function(t,n){e.push({x:-20+n,y:20}),e.push({x:-20+n,y:-20}),e.push({x:20,y:-20+n}),e.push({x:-20,y:-20+n})})),function(){return e}}(),n=!1;return{step:function(r,o){var i=e.current;i&&(n=function(e,t,n){return T(e,t)||T(e,n)}(r,o,t()))&&K(i)},start:function(){var t=e.current;t&&(n=!1,function(e){k.getObject3DByName(e,w).intensity=1}(t))},end:function(){var t=e.current;t&&(n=!0,K(t))},isContinued:function(){return!n}}},J=n(29);!function(e){e[e.LeftArrow=0]="LeftArrow",e[e.RightArrow=1]="RightArrow",e[e.None=2]="None"}(i||(i={})),function(e){e[e.LeftArrow=0]="LeftArrow",e[e.RightArrow=1]="RightArrow"}(c||(c={})),function(e){e[e.Up=0]="Up",e[e.Right=270]="Right",e[e.Down=180]="Down",e[e.Left=90]="Left"}(a||(a={}));var V=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;switch(t){case a.Down:return{x:e.x,y:e.y-n,angle:a.Down};case a.Right:return{x:e.x+n,y:e.y,angle:a.Right};case a.Up:return{x:e.x,y:e.y+n,angle:a.Up};case a.Left:return{x:e.x-n,y:e.y,angle:a.Left};default:throw new Error("calculateNewPosition. Unknown newDirection type = ".concat(t))}},W=function(){return{initDuckyPosition:Object(J.a)({},g),initTailPosition:[]}},z=function(e,t){var n=W(),r=n.initDuckyPosition,o=n.initTailPosition,c=r,u=o;return{reset:function(){var t=e.current;if(t){u.forEach((function(e,n){N(t,A(n),{x:0,y:0,angle:0},!0)}));var n=W(),r=n.initDuckyPosition,o=n.initTailPosition;c=r,u=o}},addMagmacube:function(){var e=Object(J.a)({},u[u.length-1]);u.push(Object(J.a)({},e))},step:function(t){var n=e.current;if(n){var r=function(e,t,n,r){try{N(e,y,t),n.forEach((function(t,n){N(e,A(n),t)}))}catch(o){console.error(o)}return[V(t,r),n.length?[Object(J.a)({},t)].concat(Object(j.a)(n.slice(0,-1))):[]]}(n,c,u,function(e,t){if(e===i.None)return t;var n=[a.Up,a.Right,a.Down,a.Left],r=[a.Up,a.Left,a.Down,a.Right],o=e===i.LeftArrow?r:n,c=o.indexOf(t);return o[(c+1)%o.length]}(t,c.angle)),o=Object(d.a)(r,2),s=o[0],f=o[1];c=s,u=f}},microStep:function(){var n=e.current;n&&function(e,t,n,r){var o=r(),i=function(t,n,r){try{var o=C(e,t),i=V(o,n,r);N(e,t,i)}catch(c){console.error(c)}};i(y,t.angle,1/o),n.forEach((function(e,t){var n=e.angle;return i(A(t),n,1/o)}))}(n,c,u,t)},getPositions:function(){return{head:c,tail:u}}}},G=function(e){e.timerId&&clearInterval(e.timerId)},X=function(e){var t=Math.ceil(e/50)||1;return{updatesByStep:t,timerInterval:Math.floor(e/t)}},Y=function(e,t){return Object(J.a)({stepInterval:e,stepIntervalDecreaseValue:t,timerId:null,updatesByStepCounter:0},X(e))},q=function(e,t){var n=Y(e,t);return{reset:function(){G(n),n=Y(e,t)},stop:function(){G(n)},step:function(e,t){!function(e,t,n){e.updatesByStepCounter=e.updatesByStep-1,e.timerId=window.setInterval((function(){if(t(),0===e.updatesByStepCounter)return G(e),void n();e.updatesByStepCounter-=1}),e.timerInterval)}(n,e,t)},increaseSpeed:function(){!function(e){var t=e.stepInterval,n=e.stepIntervalDecreaseValue,r=t-n<50?50:t-n,o=X(r),i=o.updatesByStep,c=o.timerInterval;e.stepInterval=r,e.updatesByStep=i,e.timerInterval=c}(n)},getUpdatesByStep:function(){return n.updatesByStep}}},H=n(11),Q={ArrowLeft:c.LeftArrow,ArrowRight:c.RightArrow},$=function(){var e=Object(s.useRef)(void 0),t=Object(s.useRef)(!1);return Object(s.useEffect)((function(){var n=function(n){var r,o=(r=n.key,Q[r]),i=function(e){return"R"===e||"r"===e}(n.key);void 0!==o&&(e.current=o),i&&(t.current=!0)};return document.addEventListener("keydown",n),function(){return document.removeEventListener("keydown",n)}}),[]),{getPressedDirectionKey:function(){var t,n=e.current;e.current=void 0;var r=(t={},Object(H.a)(t,c.LeftArrow,i.LeftArrow),Object(H.a)(t,c.RightArrow,i.RightArrow),t);return void 0===n?i.None:r[n]},isResetKeyPressed:function(){var e=t.current;return t.current=!1,e}}},_=function(e){var t=$(),n=t.getPressedDirectionKey,r=t.isResetKeyPressed,o=Object(s.useState)(0),i=Object(d.a)(o,2),c=i[0],a=i[1];return Object(s.useEffect)((function(){var t=function(){},o=setInterval((function(){e.current&&k.isSceneReady(e.current)&&(clearInterval(o),t=function(){var t=q(O,v),o=z(e,t.getUpdatesByStep),i=F(e),c=Z(e);return o.step(n()),function e(){t.step((function(){return c.isContinued()&&o.microStep()}),(function(){var u=o.getPositions();c.step(u.head,u.tail),c.isContinued()&&(i.step([u.head].concat(Object(j.a)(u.tail))).isSnakeEatApple&&(a((function(e){return e+1})),t.increaseSpeed(),o.addMagmacube()),o.step(n())),r()&&(a(0),t.reset(),o.reset(),i.reset(),c.start()),e()}))}(),t.stop}())}),100);return t}),[]),{score:c}},ee=function(e){var t=e.score;return Object(u.jsxs)("div",{className:"info-wrapper",children:[Object(u.jsx)("p",{className:"info-score",children:"Score: ".concat(t)}),Object(u.jsx)("p",{children:"'\u2190' - turn left"}),Object(u.jsx)("p",{children:"'\u2192' - turn right"}),Object(u.jsx)("p",{children:"'r' - restart game"})]})},te=n(62),ne=n(34);Object(M.e)(o);var re=function(){var e=Object(s.useRef)(),t=Object(s.useRef)(),n=Object(M.h)(),r=n.scene,o=n.setDefaultCamera,i=n.camera,c=n.gl.domElement;return Object(s.useEffect)((function(){var t=null===e||void 0===e?void 0:e.current;t&&o(t)}),[o,r]),Object(u.jsxs)("group",{children:[Object(u.jsx)("perspectiveCamera",{ref:e,position:[b,b,b],up:[0,0,1]}),Object(u.jsx)("orbitControls",{enablePan:!1,ref:t,args:[i,c],enableKeys:!1,minZoom:1,maxZoom:1,minDistance:26,maxDistance:60,enableDamping:!0,dampingFactor:.05,screenSpacePanning:!1,minPolarAngle:B(0),maxPolarAngle:B(75)})]})},oe=n(0),ie=n(42),ce=function(e,t,n){return{type:"defined",number:e,speed:t,offset:null!==n&&void 0!==n?n:0}},ae=function(e,t){var n=Object(M.g)(ie.a,e),r=n.scene.clone(),o=Object(s.useState)((function(){return new oe.AnimationMixer(r)})),i=Object(d.a)(o,1)[0],c=Object(s.useRef)(null),a=Object(M.h)().clock;return Object(s.useEffect)((function(){if("undefined"!==t.type){i.timeScale=t.speed;var e=n.animations[t.number];e&&i.clipAction(e).startAt(t.offset).play()}}),[n,i,t]),Object(M.f)((function(){var e=c.current,t=a.getElapsedTime(),n=t-(null!==e&&void 0!==e?e:0);c.current=t,i.update(n),a.getElapsedTime()})),r},ue=function(){var e=ae("models/apple/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{name:x,position:[0,0,-100],dispose:null,children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:e,rotation:[B(90),0,0],position:[0,-.2,.8],scale:[15e-5,15e-5,15e-5]})})})},se=function(e){var t=e.position,n=e.angle,r=ae("models/bigTree/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{position:[].concat(Object(j.a)(t),[0]),dispose:null,rotation:[0,0,n],children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:r,rotation:[B(90),0,0],position:[0,0,.8],scale:[40,40,40]})})})},fe=function(e){var t=e.position,n=e.angle,r=ae("models/bush/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{position:[].concat(Object(j.a)(t),[0]),rotation:[0,0,n],dispose:null,children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:r,rotation:[B(90),0,0],position:[0,0,.2],scale:[.04,.04,.04]})})})},le=function(e){var t=e.position,n=e.angle,r=e.name,o=ae("models/ducky/scene.gltf",ce(0,4));return Object(u.jsx)("group",{name:r,position:[].concat(Object(j.a)(t),[0]),dispose:null,rotation:[0,0,n],children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:o,rotation:[B(90),0,0],position:[0,0,.5],scale:[.08,.08,.08]})})})},pe=function(e){var t=e.cubeNumber,n=void 0===t?0:t,r=e.name,o=ae("models/magmacube/scene.gltf",ce(0,1,.1*n));return Object(u.jsx)("group",{name:r,position:[0,0,-100],children:Object(u.jsx)("primitive",{object:o,rotation:[B(90),B(180),0],position:[0,0,.9],scale:[.1,.1,.1]})})},je=function(e){var t=e.position,n=e.angle,r=ae("models/palmTree/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{position:[].concat(Object(j.a)(t),[0]),dispose:null,rotation:[0,0,n],children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:r,rotation:[B(90),0,0],position:[0,0,.8],scale:[80,80,80]})})})},de=function(e,t,n){return new Array(e).fill(0).map((function(){var e,r,o=[Math.floor((Math.random()-.5)*t),Math.floor((Math.random()-.5)*t)],i=Object(d.a)(o,2),c=i[0],a=i[1];return r=a,(e=c)>=-n&&e<=n&&r>=-n&&r<=n?null:{x:c,y:a,angle:Math.floor(4*Math.random())*(Math.PI/2)}})).filter((function(e){return Boolean(e)}))},be=function(){var e=Object(M.g)(oe.TextureLoader,"textures/grass.jpg");Object(s.useEffect)((function(){e.wrapS=oe.RepeatWrapping,e.wrapT=oe.RepeatWrapping,e.repeat.set(m,m)}),[e]);var t=Object(s.useMemo)((function(){return de(60,m,b)}),[]),n=Object(s.useMemo)((function(){return de(60,m,b)}),[]),r=Object(s.useMemo)((function(){return function(e,t,n){var r=Math.floor(2*n/8),o=e>4*r?e-4*r:0,i=n/2+5;return[].concat(Object(j.a)(new Array(r).fill(0).map((function(e,t){return{x:8*t-i,y:-i,angle:Math.random()*Math.PI*2}}))),Object(j.a)(new Array(r).fill(0).map((function(e,t){return{x:8*t-i,y:i,angle:Math.random()*Math.PI*2}}))),Object(j.a)(new Array(r).fill(0).map((function(e,t){return{x:i,y:8*t-i,angle:Math.random()*Math.PI*2}}))),Object(j.a)(new Array(r).fill(0).map((function(e,t){return{x:-i,y:8*t-i,angle:Math.random()*Math.PI*2}}))),Object(j.a)(de(o,t,i+1)))}(1e3,m,b)}),[]),o=function(e,t){return Object(u.jsx)(u.Fragment,{children:e.map((function(e){var n=e.x,r=e.y,o=e.angle;return Object(u.jsx)(t,{position:[n,r],angle:o},"".concat(n).concat(r).concat(o))}))})};return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("fog",{attach:"fog",args:["black",b,80]}),Object(u.jsxs)("mesh",{children:[Object(u.jsx)("boxBufferGeometry",{attach:"geometry",args:[m,m,1]}),Object(u.jsx)("meshStandardMaterial",{attach:"material",color:"green",map:e}),o(t,je),o(n,se),o(r,fe)]})]})},me=function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(le,{name:y,position:[0,0],angle:0}),new Array(100).fill(0).map((function(e,t){return Object(u.jsx)(pe,{name:A(t),cubeNumber:t},A(t))}))]})},he=Object(s.forwardRef)((function(e,t){return Object(u.jsxs)(M.a,{color:"red",children:[Object(u.jsx)(re,{}),Object(u.jsx)("ambientLight",{name:w,intensity:1}),Object(u.jsx)(te.a,{}),Object(u.jsxs)(s.Suspense,{fallback:null,children:[Object(u.jsx)(be,{}),Object(u.jsx)(me,{}),Object(u.jsx)(ue,{}),Object(u.jsx)(I,{ref:t})]})]})})),ge=f.a.memo(he),Oe=function(){var e=Object(s.useRef)(null),t=_(e).score;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(ee,{score:t}),Object(u.jsx)(ge,{ref:e})]})};n(84);p.a.render(Object(u.jsx)(f.a.StrictMode,{children:Object(u.jsx)(Oe,{})}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.1e6c91c0.chunk.js.map