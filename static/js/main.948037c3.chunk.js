(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getObject3DByName",(function(){return S})),n.d(r,"getObject3DPositionByName",(function(){return P})),n.d(r,"setObject3DPositionByName",(function(){return R})),n.d(r,"isSceneReady",(function(){return D}));var i={};n.r(i),n.d(i,"OrbitControls",(function(){return re.b}));var o,c,a,u=n(5),s=n(1),f=n.n(s),l=n(28),j=n.n(l),p=n(14),d=n(10),b=20,m=1e3,g=80,O={x:10,y:10,angle:180},h=700,v=10,y="ducky",x="apple",w="ambientLight",A=function(e){return"".concat("magmacube").concat(e)},M=n(9),S=function(e,t){var n=e.children.find((function(e){return e.name===t}));if(void 0===n)throw new Error("getObject3DByName. Can't find model with name=".concat(t,", scene=").concat(e));return n},P=function(e,t){var n=S(e,t);return{x:n.position.x,y:n.position.y,angle:n.rotation.z}},R=function(e,t,n,r){var i=S(e,t);i.position.setX(n.x),i.position.setY(n.y),i.position.setZ(r?-100:0),i.rotation.set(0,0,n.angle)},D=function(e){try{return S(e,y),S(e,x),!0}catch(t){return!1}},I=Object(s.forwardRef)((function(e,t){var n=Object(M.h)().scene;return null!==t&&"function"!==typeof t&&(t.current=n),null})),L=r,k=function(e){return e*Math.PI/180},B=10,E=function(e){return"number"===typeof e?e-B:{x:e.x-B,y:e.y-B}},N=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=E({x:n.x,y:n.y}),o=i.x,c=i.y,a=k(n.angle);L.setObject3DPositionByName(e,t,{x:o,y:c,angle:a},r)},C=function(e,t){var n,r=L.getObject3DPositionByName(e,t),i="number"===typeof(n={x:r.x,y:r.y})?n+B:{x:n.x+B,y:n.y+B};return{x:i.x,y:i.y,angle:r.angle/Math.PI*180}},T=function(e,t){var n=e.x,r=e.y;return t.filter((function(e){var t=e.x,i=e.y;return t===n&&i===r})).length>0},U=function(e){for(var t=function(){return[Math.floor(Math.random()*b),Math.floor(Math.random()*b)]},n=t(),r=Object(d.a)(n,2),i=r[0],o=r[1];T({x:i,y:o},e);){var c=t(),a=Object(d.a)(c,2);i=a[0],o=a[1]}return{x:i,y:o,angle:0}},F=function(e){var t=U([O]);return{reset:function(){t=U([O])},step:function(n){var r=e.current;if(!r)return{isSnakeEatApple:!1};var i=function(e,t,n){var r=function(e,t){return function(e,t){var n=e.x,r=e.y,i=t.x,o=t.y;return n===i&&r===o}(e,t[0])}(t,n),i=t;return r&&(i=U(n)),N(e,x,i),{isSnakeEatApple:r,actualApplePosition:i}}(r,t,n),o=i.isSnakeEatApple,c=i.actualApplePosition;return t=c,{isSnakeEatApple:o}}}},K=function(e){L.getObject3DByName(e,w).intensity=0},Z=function(e){var t=function(){var e=[];return new Array(g).fill(0).forEach((function(t,n){var r=-30+n;e.push({x:r,y:50}),e.push({x:r,y:-30}),e.push({x:50,y:r}),e.push({x:-30,y:r})})),function(){return e}}(),n=!1;return{step:function(r,i){var o=e.current;o&&(n=function(e,t,n){return T(e,t)||T(e,n)}(r,i,t()))&&K(o)},start:function(){var t=e.current;t&&(n=!1,function(e){L.getObject3DByName(e,w).intensity=1}(t))},end:function(){var t=e.current;t&&(n=!0,K(t))},isContinued:function(){return!n}}},J=n(29);!function(e){e[e.LeftArrow=0]="LeftArrow",e[e.RightArrow=1]="RightArrow",e[e.None=2]="None"}(o||(o={})),function(e){e[e.LeftArrow=0]="LeftArrow",e[e.RightArrow=1]="RightArrow"}(c||(c={})),function(e){e[e.Up=0]="Up",e[e.Right=270]="Right",e[e.Down=180]="Down",e[e.Left=90]="Left"}(a||(a={}));var V=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;switch(t){case a.Down:return{x:e.x,y:e.y-n,angle:a.Down};case a.Right:return{x:e.x+n,y:e.y,angle:a.Right};case a.Up:return{x:e.x,y:e.y+n,angle:a.Up};case a.Left:return{x:e.x-n,y:e.y,angle:a.Left};default:throw new Error("calculateNewPosition. Unknown newDirection type = ".concat(t))}},W=function(){return{initDuckyPosition:Object(J.a)({},O),initTailPosition:[]}},z=function(e,t){var n=W(),r=n.initDuckyPosition,i=n.initTailPosition,c=r,u=i;return{reset:function(){var t=e.current;if(t){u.forEach((function(e,n){N(t,A(n),{x:0,y:0,angle:0},!0)}));var n=W(),r=n.initDuckyPosition,i=n.initTailPosition;c=r,u=i}},addMagmacube:function(){var e=Object(J.a)({},u[u.length-1]);u.push(Object(J.a)({},e))},step:function(t){var n=e.current;if(n){var r=function(e,t,n,r){try{N(e,y,t),n.forEach((function(t,n){N(e,A(n),t)}))}catch(i){console.error(i)}return[V(t,r),n.length?[Object(J.a)({},t)].concat(Object(p.a)(n.slice(0,-1))):[]]}(n,c,u,function(e,t){if(e===o.None)return t;var n=[a.Up,a.Right,a.Down,a.Left],r=[a.Up,a.Left,a.Down,a.Right],i=e===o.LeftArrow?r:n,c=i.indexOf(t);return i[(c+1)%i.length]}(t,c.angle)),i=Object(d.a)(r,2),s=i[0],f=i[1];c=s,u=f}},microStep:function(){var n=e.current;n&&function(e,t,n,r){var i=r(),o=function(t,n,r){try{var i=C(e,t),o=V(i,n,r);N(e,t,o)}catch(c){console.error(c)}};o(y,t.angle,1/i),n.forEach((function(e,t){var n=e.angle;return o(A(t),n,1/i)}))}(n,c,u,t)},getPositions:function(){return{head:c,tail:u}}}},G=function(e){e.timerId&&clearInterval(e.timerId)},X=function(e){var t=Math.ceil(e/50)||1;return{updatesByStep:t,timerInterval:Math.floor(e/t)}},Y=function(e,t){return Object(J.a)({stepInterval:e,stepIntervalDecreaseValue:t,timerId:null,updatesByStepCounter:0},X(e))},q=function(e,t){var n=Y(e,t);return{reset:function(){G(n),n=Y(e,t)},stop:function(){G(n)},step:function(e,t){!function(e,t,n){e.updatesByStepCounter=e.updatesByStep-1,e.timerId=window.setInterval((function(){if(t(),0===e.updatesByStepCounter)return G(e),void n();e.updatesByStepCounter-=1}),e.timerInterval)}(n,e,t)},increaseSpeed:function(){!function(e){var t=e.stepInterval,n=e.stepIntervalDecreaseValue,r=t-n<50?50:t-n,i=X(r),o=i.updatesByStep,c=i.timerInterval;e.stepInterval=r,e.updatesByStep=o,e.timerInterval=c}(n)},getUpdatesByStep:function(){return n.updatesByStep}}},H=n(11),Q={ArrowLeft:c.LeftArrow,ArrowRight:c.RightArrow},$=function(){var e=Object(s.useRef)(void 0),t=Object(s.useRef)(!1);return Object(s.useEffect)((function(){var n=function(n){var r,i=(r=n.key,Q[r]),o=function(e){return"R"===e||"r"===e}(n.key);void 0!==i&&(e.current=i),o&&(t.current=!0)};return document.addEventListener("keydown",n),function(){return document.removeEventListener("keydown",n)}}),[]),{getPressedDirectionKey:function(){var t,n=e.current;e.current=void 0;var r=(t={},Object(H.a)(t,c.LeftArrow,o.LeftArrow),Object(H.a)(t,c.RightArrow,o.RightArrow),t);return void 0===n?o.None:r[n]},isResetKeyPressed:function(){var e=t.current;return t.current=!1,e}}},_=function(e){var t=$(),n=t.getPressedDirectionKey,r=t.isResetKeyPressed,i=Object(s.useState)(0),o=Object(d.a)(i,2),c=o[0],a=o[1],u=Object(s.useState)(!0),f=Object(d.a)(u,2),l=f[0],j=f[1];return Object(s.useEffect)((function(){var t=function(){},i=setInterval((function(){e.current&&L.isSceneReady(e.current)&&(clearInterval(i),j(!1),t=function(){var t=q(h,v),i=z(e,t.getUpdatesByStep),o=F(e),c=Z(e);return i.step(n()),function e(){t.step((function(){return c.isContinued()&&i.microStep()}),(function(){var u=i.getPositions();c.step(u.head,u.tail),c.isContinued()&&(o.step([u.head].concat(Object(p.a)(u.tail))).isSnakeEatApple&&(a((function(e){return e+1})),t.increaseSpeed(),i.addMagmacube()),i.step(n())),r()&&(a(0),t.reset(),i.reset(),o.reset(),c.start()),e()}))}(),t.stop}())}),100);return t}),[]),{score:c,isLoading:l}},ee=function(e){var t=e.score;return Object(u.jsxs)("div",{className:"info-wrapper",children:[Object(u.jsx)("p",{className:"info-score",children:"Score: ".concat(t)}),Object(u.jsx)("p",{children:"'\u2190' - turn left"}),Object(u.jsx)("p",{children:"'\u2192' - turn right"}),Object(u.jsx)("p",{children:"'r' - restart game"})]})},te=function(){return Object(u.jsx)("div",{className:"loading",children:"Loading..."})},ne=n(62),re=n(34);Object(M.e)(i);var ie=function(){var e=Object(s.useRef)(),t=Object(s.useRef)(),n=Object(M.h)(),r=n.scene,i=n.setDefaultCamera,o=n.camera,c=n.gl.domElement;return Object(s.useEffect)((function(){var t=null===e||void 0===e?void 0:e.current;t&&i(t)}),[i,r]),Object(u.jsxs)("group",{children:[Object(u.jsx)("perspectiveCamera",{ref:e,position:[b,b,b],up:[0,0,1]}),Object(u.jsx)("orbitControls",{enablePan:!1,ref:t,args:[o,c],enableKeys:!1,minZoom:1,maxZoom:1,minDistance:26,maxDistance:60,enableDamping:!0,dampingFactor:.05,screenSpacePanning:!1,minPolarAngle:k(0),maxPolarAngle:k(75)})]})},oe=n(0),ce=n(42),ae=function(e,t,n){return{type:"defined",number:e,speed:t,offset:null!==n&&void 0!==n?n:0}},ue=function(e,t){var n=Object(M.g)(ce.a,e),r=n.scene.clone(),i=Object(s.useState)((function(){return new oe.AnimationMixer(r)})),o=Object(d.a)(i,1)[0],c=Object(s.useRef)(null),a=Object(M.h)().clock;return Object(s.useEffect)((function(){if("undefined"!==t.type){o.timeScale=t.speed;var e=n.animations[t.number];e&&o.clipAction(e).startAt(t.offset).play()}}),[n,o,t]),Object(M.f)((function(){var e=c.current,t=a.getElapsedTime(),n=t-(null!==e&&void 0!==e?e:0);c.current=t,o.update(n),a.getElapsedTime()})),r},se=function(){var e=ue("models/apple/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{name:x,position:[0,0,-100],dispose:null,children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:e,rotation:[k(90),0,0],position:[0,-.2,.8],scale:[15e-5,15e-5,15e-5]})})})},fe=function(e){var t=e.position,n=e.angle,r=ue("models/bigTree/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{position:[].concat(Object(p.a)(t),[0]),dispose:null,rotation:[0,0,n],children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:r,rotation:[k(90),0,0],position:[0,0,.8],scale:[40,40,40]})})})},le=function(e){var t=e.position,n=e.angle,r=ue("models/bush/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{position:[].concat(Object(p.a)(t),[0]),rotation:[0,0,n],dispose:null,children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:r,rotation:[k(90),0,0],position:[0,0,.2],scale:[.04,.04,.04]})})})},je=function(e){var t=e.position,n=e.angle,r=e.name,i=ue("models/ducky/scene.gltf",ae(0,4));return Object(u.jsx)("group",{name:r,position:[].concat(Object(p.a)(t),[0]),dispose:null,rotation:[0,0,n],children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:i,rotation:[k(90),0,0],position:[0,0,.5],scale:[.08,.08,.08]})})})},pe=function(e){var t=e.cubeNumber,n=void 0===t?0:t,r=e.name,i=ue("models/magmacube/scene.gltf",ae(0,1,.1*n));return Object(u.jsx)("group",{name:r,position:[0,0,-100],children:Object(u.jsx)("primitive",{object:i,rotation:[k(90),k(180),0],position:[0,0,.9],scale:[.1,.1,.1]})})},de=function(e){var t=e.position,n=e.angle,r=ue("models/palmTree/scene.gltf",{type:"undefined"});return Object(u.jsx)("group",{position:[].concat(Object(p.a)(t),[0]),dispose:null,rotation:[0,0,n],children:Object(u.jsx)("mesh",{children:Object(u.jsx)("primitive",{object:r,rotation:[k(90),0,0],position:[0,0,.8],scale:[80,80,80]})})})},be=function(e,t,n){return new Array(e).fill(0).map((function(){var e,r,i=[Math.floor((Math.random()-.5)*t),Math.floor((Math.random()-.5)*t)],o=Object(d.a)(i,2),c=o[0],a=o[1];return r=a,(e=c)>=-n&&e<=n&&r>=-n&&r<=n?null:{x:c,y:a,angle:Math.floor(4*Math.random())*(Math.PI/2)}})).filter((function(e){return Boolean(e)}))},me=function(){var e=Object(M.g)(oe.TextureLoader,"textures/grass.jpg");Object(s.useEffect)((function(){e.wrapS=oe.RepeatWrapping,e.wrapT=oe.RepeatWrapping,e.repeat.set(m,m)}),[e]);var t=Object(s.useMemo)((function(){return be(60,m,b)}),[]),n=Object(s.useMemo)((function(){return be(60,m,b)}),[]),r=Object(s.useMemo)((function(){return function(e,t,n){var r=Math.floor(2*n/8),i=e>4*r?e-4*r:0,o=n/2+5;return[].concat(Object(p.a)(new Array(r).fill(0).map((function(e,t){return{x:8*t-o,y:-o,angle:Math.random()*Math.PI*2}}))),Object(p.a)(new Array(r).fill(0).map((function(e,t){return{x:8*t-o,y:o,angle:Math.random()*Math.PI*2}}))),Object(p.a)(new Array(r).fill(0).map((function(e,t){return{x:o,y:8*t-o,angle:Math.random()*Math.PI*2}}))),Object(p.a)(new Array(r).fill(0).map((function(e,t){return{x:-o,y:8*t-o,angle:Math.random()*Math.PI*2}}))),Object(p.a)(be(i,t,o+1)))}(1e3,m,b)}),[]),i=function(e,t){return Object(u.jsx)(u.Fragment,{children:e.map((function(e){var n=e.x,r=e.y,i=e.angle;return Object(u.jsx)(t,{position:[n,r],angle:i},"".concat(n).concat(r).concat(i))}))})};return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("fog",{attach:"fog",args:["black",b,80]}),Object(u.jsxs)("mesh",{children:[Object(u.jsx)("boxBufferGeometry",{attach:"geometry",args:[m,m,1]}),Object(u.jsx)("meshStandardMaterial",{attach:"material",color:"green",map:e}),i(t,de),i(n,fe),i(r,le)]})]})},ge=function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(je,{name:y,position:[0,0],angle:0}),new Array(100).fill(0).map((function(e,t){return Object(u.jsx)(pe,{name:A(t),cubeNumber:t},A(t))}))]})},Oe=Object(s.forwardRef)((function(e,t){return Object(u.jsxs)(M.a,{color:"red",children:[Object(u.jsx)(ie,{}),Object(u.jsx)("ambientLight",{name:w,intensity:1}),Object(u.jsx)(ne.a,{}),Object(u.jsxs)(s.Suspense,{fallback:null,children:[Object(u.jsx)(me,{}),Object(u.jsx)(ge,{}),Object(u.jsx)(se,{}),Object(u.jsx)(I,{ref:t})]})]})})),he=f.a.memo(Oe),ve=function(){var e=Object(s.useRef)(null),t=_(e),n=t.score,r=t.isLoading;return Object(u.jsxs)(u.Fragment,{children:[r&&Object(u.jsx)(te,{}),!r&&Object(u.jsx)(ee,{score:n}),Object(u.jsx)(he,{ref:e})]})};n(84);j.a.render(Object(u.jsx)(f.a.StrictMode,{children:Object(u.jsx)(ve,{})}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.948037c3.chunk.js.map